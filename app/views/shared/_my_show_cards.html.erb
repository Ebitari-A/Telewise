<div class="myshow-body">
  <% if @user.progresses.empty? %>
    <% @user.followed_shows.each do |show| %>
      <div class="card-box">

        <div class="my-show-image-wrapper" id="myshow-image">
          <%# <div id="myshow-image" style="background-image: url('= image_path("#{show.show.name.gsub(/\s+/, "")}.jpg")')"> </div> %>
          <%= image_tag("#{show.show.name.gsub(/\s+/, '')}.jpg") %>
        </div>
        <div class="card-body">
          <a href="<%= show_path(show.show) %>" class="search-link d-flex">
          <div class="title-date">
            <div class="title-delete">
              <h5 class="card-title"><%= show.show.name %> </h5>

              <%= link_to "+", user_followed_show_path(current_user, show), method: :delete, class: "danger-btn" %>
            </div>
            <% future_episodes = show.show.episodes.select do |episode| %>
              <% episode.airing_date > DateTime.now %>
            <% end %>
            <% past_episodes = show.show.episodes.select do |episode| %>
              <% episode.airing_date < DateTime.now %>
            <% end %>
            <div class="text-muted airing-date-text">
              <% if future_episodes.empty? %>
                <p><small>Last episode date: <%= show.show.episodes.last.airing_date.strftime("%d.%m.%Y") %></small></p>
              <% else %>
                <p><small>Last episode date: <%= past_episodes.last.airing_date.strftime("%d.%m.%Y") %></small></p>
                <p><small>Next episode date: <%= future_episodes.first.airing_date.strftime("%d.%m.%Y") %></small></p>
              <% end %>
              </div>
            </div>
          </a>
        </div>
      </div>
    <% end %>

  <% else %>
      <% @show_progress.each do |progress, episode| %>
      <div class="card-box">
      <div class="my-show-image-wrapper" id="myshow-image">
        <%= image_tag("#{progress.show.name.gsub(/\s+/, '')}.jpg") %>
      </div>
        <div class="card-body">
          <div class="title-delete">
            <h5 class="card-title"><%= progress.show.name %></h5>
            <%= link_to "+", user_followed_show_path(current_user, progress.show), method: :delete, class: "danger-btn" %>
          </div>
          <% if episode.empty? %>
            <p class="card-text" id="noprogress">No progress so far</p>
            <p class="card-text">
          <% else %>
            Season <%= episode[0].season_number %>
            Episode <%= episode[0].episode_number %>
          <% end %>
          </p>
        </div>
      </div>
    <% end %>
  <% end %>
</div>
